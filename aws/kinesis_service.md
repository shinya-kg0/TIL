# Kinesis Data Streams vs Amazon Data Firehose

Kinesis Data Streams（KDS）と Amazon Data Firehose（ADF）は、どちらもストリーミングデータを扱いますが、役割が全く異なります。

一言でいうと、**「データをリアルタイムに『処理』するための KDS」**と、**「データをどこかに『運ぶ』ための Firehose」**です。

---

## 1. 一目でわかる比較表

| 項目 | Kinesis Data Streams (KDS) | Amazon Data Firehose (ADF) |
| --- | --- | --- |
| **主な目的** | **リアルタイム処理・分析** | **ストレージへの保存（配信）** |
| **データの届け先** | 独自のアプリ、Lambda、Flinkなど | S3, Redshift, OpenSearchなど |
| **遅延 (レイテンシ)** | **1秒未満** (超リアルタイム) | **60秒〜900秒** (バッファリング) |
| **管理のしやすさ** | シャードの管理が必要（やや複雑） | **フルマネージド**（設定のみで楽） |
| **データの加工** | 自身でプログラムを書く必要がある | 配信途中でLambdaによる簡易加工が可能 |
| **データの再利用** | 同じデータを複数のアプリで読める | 基本的に一方通行（送りっぱなし） |

---

## 2. それぞれのイメージ

### Kinesis Data Streams： 「超高速の動く歩道」

* データの発生源から流れてくるものを、**止めることなく**次の処理へ回します。
* 「今この瞬間に不正アクセスを検知したい」「今の株価で即座に計算したい」といった、**コンマ数秒の速さ**が求められる時に使います。
* 読み手（プログラム）を自分で用意する必要があります。

### Amazon Data Firehose： 「全自動の配送トラック」

* データを一定量（または一定時間）貯めてから、指定した場所（S3など）へ**ドサッとまとめて運びます。**
* 「分析のためにログをS3に溜めたい」「Redshiftにデータをロードしたい」といった、**保存が目的**の時に使います。
* プログラムを書く必要がなく、ポチポチ設定するだけで動くのが最大の特徴です。

---

## 3. よくある黄金パターン（連携）

実務では、この2つを組み合わせて使うことが非常に多いです。

1. まず **Kinesis Data Streams** で全データを受け止める。
2. **パターンA：** リアルタイム分析アプリが、Streamsからデータを拾って即座に計算。
3. **パターンB：** 同時に **Firehose** がStreamsからデータをコピーし、バックアップとして S3 に保存。

このように、「今の判断」と「後で分析するための保存」を両立させます。

---

## まとめ




Kinesis Data Streams（KDS）と Amazon Data Firehose（ADF）の使い分けを、「目的」と「ユースケース」に絞ってさらに深掘りして解説します。

結論から言うと、**「データを料理してすぐ出す（KDS）」**か、**「データを倉庫に運んで貯める（ADF）」**かの違いです。

---

## 1. 目的の違い

### Kinesis Data Streams (KDS)

* **目的**: **「継続的なストリーム処理」**
* データが生成された瞬間に、それに対して何らかのロジック（計算、判定、フィルタリング）を実行し、その結果を次のアクションに繋げるための「リアルタイム基盤」です。
* データは読み取られても一定期間（24時間〜）残るため、複数の異なるアプリケーションが同じデータストリームをそれぞれの目的で並列に処理できます。

### Amazon Data Firehose (ADF)

* **目的**: **「ストリームデータの配信（ロード）」**
* 流れてくるデータを、S3、Redshift、OpenSearch、あるいはサードパーティ（Datadog, Splunk等）へ「自動で届けること」に特化したサービスです。
* 基本的には「受信 →（必要なら簡易変換）→ 配信」という一方通行のパイプラインです。

---

## 2. 具体的なユースケースの違い

### Kinesis Data Streams が最適なケース

1. **リアルタイム不正検知**:
クレジットカードの決済データが流れてきた瞬間に、機械学習モデルと照らし合わせて「不正」と判定されたら即座に決済をブロックする。
2. **動的な価格設定（ダイナミックプライシング）**:
ホテルの予約状況や競合の価格変更をリアルタイムに集計し、即座に自社の価格を更新・配信する。
3. **複雑なイベント相関分析**:
「Aというエラーが出た後に、Bという操作が5秒以内に行われたらアラートを出す」といった、時間軸を伴う複雑な条件判定。

### Amazon Data Firehose が最適なケース

1. **ログのアーカイブと分析準備**:
アプリケーションの全アクセスログを S3 に保存し、後で Amazon Athena を使って分析できるようにする（この際、JSONをParquet形式に自動変換させることが多いです）。
2. **セキュリティ情報の集中管理 (SIEM)**:
VPC フローログなどを CloudWatch Logs から受け取り、そのまま Splunk や OpenSearch Service に流し込んで可視化する。
3. **データレイクへのロード**:
IoTデバイスからの大量の生データを、分析基盤（Redshift）へ定期的にバッチロードする。

---

## 3. 判断のチェックリスト

どちらを使うべきか迷った際は、以下の3つの質問で判断できます。

* **Q1. 1秒以内の即時アクションが必要か？**
  * Yes → **Kinesis Data Streams**
  * No（1分〜数分後の保存で良い） → **Firehose**


* **Q2. 同じデータを「分析チーム」と「監視チーム」など、複数箇所で独立して読み取りたいか？**
  * Yes → **Kinesis Data Streams**
  * No（特定の保存先に届けば良い） → **Firehose**


* **Q3. プログラミング（Lambdaや独自アプリ）を最小限にしたいか？**
  * Yes（設定だけで済ませたい） → **Firehose**
  * No（独自の重厚な処理を書きたい） → **Kinesis Data Streams**



---

### まとめ

* **KDS** = リアルタイムな「知能（処理）」が必要なとき
* **速さ（リアルタイム性）**と**自由な加工**を求めるなら → **Kinesis Data Streams**

* **ADF** = 確実かつ楽な「配送（保存）」が必要なとき
* **手軽さ**と**保存（S3などへの転送）**が目的なら → **Amazon Data Firehose**