# Linuxとは

- [ ] パス名展開を使いこなせるように  
`*.txt`, `rm *.log`

## カーネル、シェル、ターミナルの違い
### カーネル（kernel）
- **OS（オペレーティングシステム）の中核部分**であり、ハードウェアと直接やり取りを行うプログラム。
- メモリ管理、プロセス管理、ファイルシステム管理など、コンピュータの基盤となる機能を提供。
- シェルから受けた内容を実行する。
- ユーザーは直接カーネルを操作することはできない。

### シェル（shell）
- カーネルを包むインターフェースの役割。
- ユーザーが入力したコマンドを解釈し、カーネルに伝えたり、カーネルからの結果をユーザーに返したりする。（実際のコマンド実行はカーネルが行う）

### ターミナル（terminal）
- もともとはキーボードとディスプレイを備えた入出力用のハードウェアを指していたが、現在は「ターミナルエミュレータ」と呼ばれる**ソフトウェア（アプリ）**を指すことが一般的。
- ターミナル自体は、コマンドの解釈や実行は行わず、あくまで画面の入出力のインターフェースを提供するソフトウェア。

# 基本的なコマンド
## 文字操作系コマンド
Macのbashで作業していることを想定。

|処理|コマンド|
|---|---|
|一文字進める|`control + f`|
|一文字戻る|`control + b`|
|先頭へ|`control + a`|
|最後へ|`control + e`|
|一単語進む|`Alt + f`|
|一単語戻る|`Alt + b`|
|一文字削除|`control + h`|
|後ろの一文字を削除|`control + d`|
|一単語削除|`control + w`|
|カーソルから行末までカット|`control + k`|
|カーソルから行頭までカット|`control + u`|
|最後の削除内容を貼り付け|`control + y`|

## トラブル系コマンド

- コマンドを打っていたらなんか打てなくなった、、、  
→ 画面表示ロックしてるかも、、、

- なんかフリーズしてたりよくわからないからリセットしたい  
→ ˆCで解決！

- 文字化けなどでリセットしたい  
→ clearでまっさら状態に！

|処理|コマンド|
|---|---|
|画面表示をロックする|`control + s`|
|画面表示のロック解除|`control + s`|
|処理の強制終了|`control + c`|

## コマンド履歴

- 一度実行したコマンドを上下矢印で復元できる
- `control + r`で過去のコマンドを検索できる

## lessコマンド

|処理|コマンド|
|---|---|
|1画面下にスクロール|`space` or `f`|
|1画面上にスクロール| `b`|
|1行上にスクロール| `k`|
|1行下にスクロール| `j`|
|終了| `q`|

ファイル内検索したい時、、、

|処理|コマンド|
|---|---|
|下方向に向かって検索|`/<文字列>`|
|次の検索結果に移動|`n`|
|前の検索結果に移動|`N`|
|ヘルプ|`h`or`H`|

## findコマンド

```bash
find <探したいpath> [-name or -type f,d,l] <検索したい文字列>
```

- 探したいPathは`.`（カレント）でもいいし、他の階層でもOK

- 特定の名前のファイル、ディレクトリを探したい → `-name`
- タイプで絞って探したい → `-type d`（fはファイル、lはリンク）
- `*,?`を使いたい時はシングルクォートで囲む
- `-a`で繋ぐことでANDの役割ができる
  - `find . -type d -a -name 'test*'`




# ファイル操作

## シンボリックリンク

ある特定のパスをエイリアスしているイメージ

例えば、  
`/usr/bin/who` → `hogehoge`  
`/test/data/image/hogehoge.log` → `hogehoge`

```bash
ln -s /usr/bin/who hogehoge


# whoコマンドと同じ動きをする
# /usr/bin/whoを打っているのと同じ
./hogehoge
```

### 🔗 シンボリックリンクのメリット

| 項目 | 内容 |
|------|------|
| ✅ 柔軟な参照 | 実体ファイルの場所に関係なく、任意のパスでアクセス可能。 |
| ✅ 複数名での再利用 | 1つのファイルやディレクトリに複数の名前（リンク）を付けられる。 |
| ✅ ショートカットとして使える | 長いパスを短縮して簡単な名前でアクセスできる。 |
| ✅ バージョン管理に便利 | 例えば `current -> version2.3` のようにリンクを切り替えることで、バージョン変更が簡単。 |
| ✅ 構成変更が容易 | 実体ファイルを移動・変更しても、リンク先を修正すれば依存スクリプトを変えずに済む。 |
| ✅ ストレージの節約 | 実体をコピーせずに参照できるため、ディスク容量を消費しない。 |
| ✅ 読み取り専用の制御が可能 | 実体ファイルのパーミッションを維持したまま、制限付きでリンク先から操作させるようにできる。 |

# bashについて
シェルのカスタマイズについて扱う。

## エイリアスの設定
長いコマンドや何回も打つコマンドを省略形にして効率化する。

```bash
# エイリアスの設定
alias ls='ls -F'
alias <名前>='<コマンド>'

# エイリアスかどうか確認
type ls

# エイリアスの削除
unalias ls
```

### gitでエイリアスを使ってみる
```bash
git config --global alias.<短縮名> '<実際のコマンド>'

# 例えば、、、
git config --global alias.lo "log --oneline -n 10"
```

```bash
# 削除するには
git config --local --unset alias.<エイリアス名>
```


### エイリアスを一時的に解除する
一番楽なのは、`\`をつけての解除かな、、、

- フルパスを指定する
- `command ls`のようにcommandを先頭につける
- `\ls`をつける

## bashのオプション

`set`や`shopt`コマンドでオプションのオンオフができる。  
玄人向けかも、、、

例えば、
- Ctrl + Dを押してもシェルを終了しない
- すでにあるファイルをリダイレクトで上書きしない
- タイプミスの修正

## 環境変数について

- シェルに内蔵しているコマンド：組み込みコマンド
  - シェル変数を参照できる
- 実行ファイルとしてシステム上に存在しているコマンド：外部コマンド
  - シェル変数を参照できない

- `printenv`で環境変数を確認できる

### 環境変数を設定する（パスを通す）
例えば、自作のコマンド myapp の実行ファイルが /usr/local/myapp/bin/ にある。

- パスを通さないとフルパスで実行する必要がある
  - `/usr/local/myapp/bin/myapp`
- パスを通す場合
  - `export PATH=$PATH:/usr/local/myapp/bin`でパスを追加
  - これで`myapp`で実行できる

これをしておかないと、毎回フルパスを実行するか、ディレクトリを移動する必要がある。

## bashの設定について
設定してもbashを終了すると消えてしまう、、、  
 → `~/.bashrc`内に書いておけば起動時に読み込まれるので設定が保存される

**設定ファイルを編集する時は、シェルを別に開いておいた方がいい。**  
設定ファイル内に`exit`を書いてしまうと、ログインした直後にログアウトするのでbashが開けなくなってしまう。。。


# Linuxに新しいユーザーを作る
- キーパスの設定は必ずしも必要ない。
  - 設定すればPWの入力が必要なくなる。
  - PWを知っていれば、SSH接続はできる。


## rootでサーバーに入る

```bash 
ssh root@<IPアドレス>

# パスワードを入力する
```

LinuxサーバーのIPアドレスを調べておく！  
→ `ip -a`：でinet以降がIPアドレス


## ユーザーを作る
CentOSで動かすことを想定

```bash 
sudo useradd -m testuser
```

`-m`：作成したユーザーのホームディレクトリを作成する

## パスワードを設定
パスワードを2回入力したら設定完了！

```bash
sudo passwd testuser
```

ssh接続と同じように接続できる！
```bash 
ssh testuser@<IPアドレス>

# パスワードを入力する
```

# タイムスタンプの設定
ドキュメントの納品作業の一環で、タイムスタンプをつけることがある

日付指定をすることで、ド**キュメントや電子ファイルの依存関係**を明らかにする

```bash
# TMS：タイムスタンプを環境変数に設定する
export TMS=202506161200

touch -t $TMS test*.log

# zipでアーカイブ
zip -r hogehoge.zip test*.log

touch -t $TMS hogehoge.zip

# 環境変数を削除
export -n TMS

```